<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>cppzmq ä½¿ç”¨æŒ‡å—</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #0f0c29;
            background-image: linear-gradient(135deg, #0f0c29 0%, #302b63 50%, #24243e 100%);
            color: #e0e0ff;
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: rgba(20, 20, 40, 0.8);
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 0 30px rgba(100, 150, 255, 0.3);
        }

        h1 {
            color: #4cd1a8;
            text-shadow: 0 0 10px rgba(76, 209, 168, 0.5);
            border-bottom: 3px solid #4cd1a8;
            padding-bottom: 10px;
            margin-top: 0;
        }

        h2 {
            color: #ff9f7f;
            margin-top: 40px;
        }

        h3 {
            color: #a0a0ff;
            margin-top: 30px;
        }

        p {
            color: #d0d0ff;
        }

        pre {
            background-color: #1a1a2e;
            padding: 20px;
            border-radius: 10px;
            overflow-x: auto;
            border-left: 4px solid #4cd1a8;
            margin: 15px 0;
        }

        code {
            font-family: 'Courier New', monospace;
            color: #a0ffa0;
            font-size: 0.95em;
        }

        .back-link {
            position: fixed;
            right: 30px;
            top: 30px;
            z-index: 1000;
            color: #4cd1a8;
            text-decoration: none;
            font-weight: bold;
            padding: 12px 24px;
            background-color: rgba(76, 209, 168, 0.15);
            border: 2px solid rgba(76, 209, 168, 0.3);
            border-radius: 25px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
        }

        .back-link:hover {
            background-color: rgba(76, 209, 168, 0.25);
            border-color: rgba(76, 209, 168, 0.5);
            box-shadow: 0 6px 20px rgba(76, 209, 168, 0.4);
            transform: translateY(-2px);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background-color: rgba(30, 30, 50, 0.5);
            border-radius: 10px;
            overflow: hidden;
        }

        th, td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid rgba(100, 100, 150, 0.3);
        }

        th {
            background-color: rgba(76, 209, 168, 0.2);
            color: #4cd1a8;
            font-weight: bold;
        }

        tr:hover {
            background-color: rgba(100, 100, 150, 0.2);
        }

        .warning {
            background-color: rgba(255, 159, 127, 0.1);
            border-left: 4px solid #ff9f7f;
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
        }

        .note {
            background-color: rgba(76, 209, 168, 0.1);
            border-left: 4px solid #4cd1a8;
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
        }

        footer {
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid rgba(76, 209, 168, 0.3);
            text-align: center;
        }

        .footer-text {
            color: #a0a0ff;
            font-size: 0.9em;
            margin: 5px 0;
        }

        .contact-link {
            color: #4cd1a8;
            text-decoration: none;
            transition: color 0.3s ease;
        }

        .contact-link:hover {
            color: #ff9f7f;
            text-shadow: 0 0 5px rgba(255, 159, 127, 0.5);
        }
    </style>
</head>
<body>
    <div class="container">
        <a href="../index.html" class="back-link">â† è¿”å›åº“åˆ—è¡¨</a>

        <h1>cppzmq ä½¿ç”¨æŒ‡å—</h1>

        <p>cppzmq æ˜¯ ZeroMQ çš„ C++ ç»‘å®šåº“ï¼Œæ˜¯ä¸€ä¸ªè½»é‡çº§çš„ã€ä»…åŒ…å«å¤´æ–‡ä»¶çš„ç»‘å®šï¼Œæä¾›äº†ä¸€å¥—ç°ä»£ C++ æ¥å£ï¼Œç”¨äºåœ¨ C++ åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨ ZeroMQã€‚å®ƒåŸºäº RAII æ¨¡å¼ï¼Œè‡ªåŠ¨ç®¡ç†èµ„æºï¼Œä½¿ ZeroMQ çš„ä½¿ç”¨æ›´åŠ å®‰å…¨å’Œä¾¿æ·ã€‚</p>

        <h2>ğŸ“¦ å®‰è£…</h2>

        <h3>å‰ç½®è¦æ±‚</h3>
        <p>cppzmq éœ€è¦å…ˆå®‰è£… ZeroMQ åº“ï¼š</p>
        <pre><code># Ubuntu/Debian
sudo apt-get install libzmq3-dev

# macOS
brew install zeromq

# Windows (vcpkg)
vcpkg install zeromq:x64-windows</code></pre>

        <h3>é€šè¿‡ vcpkg å®‰è£…</h3>
        <pre><code>vcpkg install cppzmq</code></pre>

        <h3>é€šè¿‡ CMake å®‰è£…</h3>
        <pre><code>git clone https://github.com/zeromq/cppzmq.git
cd cppzmq
mkdir build && cd build
cmake ..
cmake --install .</code></pre>

        <h3>å¤´æ–‡ä»¶æ–¹å¼ä½¿ç”¨</h3>
        <pre><code>#include &lt;zmq.hpp&gt;  // ä»…éœ€ä¸€ä¸ªå¤´æ–‡ä»¶
// é“¾æ¥æ—¶éœ€è¦ -lzmq</code></pre>

        <h2>ğŸš€ åŸºç¡€ä½¿ç”¨</h2>

        <h3>Hello Worldï¼ˆREQ-REP æ¨¡å¼ï¼‰</h3>

        <h4>æœåŠ¡å™¨ç«¯ï¼ˆREPï¼‰</h4>
        <pre><code>#include &lt;zmq.hpp&gt;
#include &lt;iostream&gt;
#include &lt;string&gt;

int main() {
    // åˆ›å»º ZeroMQ ä¸Šä¸‹æ–‡
    zmq::context_t context(1);

    // åˆ›å»º REP å¥—æ¥å­—
    zmq::socket_t socket(context, ZMQ_REP);
    socket.bind("tcp://*:5555");

    std::cout &lt;&lt; "Server started, waiting for requests...\n";

    while (true) {
        // æ¥æ”¶è¯·æ±‚
        zmq::message_t request;
        socket.recv(request, zmq::recv_flags::none);
        std::string req_str(static_cast&lt;char*&gt;(request.data()), request.size());
        std::cout &lt;&lt; "Received: " &lt;&lt; req_str &lt;&lt; "\n";

        // å‘é€å“åº”
        std::string reply = "World";
        zmq::message_t response(reply.begin(), reply.end());
        socket.send(response, zmq::send_flags::none);
    }

    return 0;
}</code></pre>

        <h4>å®¢æˆ·ç«¯ï¼ˆREQï¼‰</h4>
        <pre><code>#include &lt;zmq.hpp&gt;
#include &lt;iostream&gt;
#include &lt;string&gt;

int main() {
    // åˆ›å»º ZeroMQ ä¸Šä¸‹æ–‡
    zmq::context_t context(1);

    // åˆ›å»º REQ å¥—æ¥å­—
    zmq::socket_t socket(context, ZMQ_REQ);
    socket.connect("tcp://localhost:5555");

    // å‘é€è¯·æ±‚
    std::string request_str = "Hello";
    zmq::message_t request(request_str.begin(), request_str.end());
    std::cout &lt;&lt; "Sending: " &lt;&lt; request_str &lt;&lt; "\n";
    socket.send(request, zmq::send_flags::none);

    // æ¥æ”¶å“åº”
    zmq::message_t reply;
    socket.recv(reply, zmq::recv_flags::none);
    std::string reply_str(static_cast&lt;char*&gt;(reply.data()), reply.size());
    std::cout &lt;&lt; "Received: " &lt;&lt; reply_str &lt;&lt; "\n";

    return 0;
}</code></pre>

        <h2>ğŸ“¤ğŸ“¥ PUB-SUB æ¨¡å¼ï¼ˆå‘å¸ƒ-è®¢é˜…ï¼‰</h2>

        <h3>å‘å¸ƒè€…ï¼ˆPUBï¼‰</h3>
        <pre><code>#include &lt;zmq.hpp&gt;
#include &lt;iostream&gt;
#include &lt;thread&gt;
#include &lt;chrono&gt;

int main() {
    zmq::context_t context(1);
    zmq::socket_t publisher(context, ZMQ_PUB);
    publisher.bind("tcp://*:5556");

    std::cout &lt;&lt; "Publisher started\n";

    int count = 0;
    while (count &lt; 10) {
        // å‘å¸ƒæ¶ˆæ¯
        std::string topic = "news";
        std::string message = "Update #" + std::to_string(count++);

        // å…ˆå‘é€ä¸»é¢˜
        zmq::message_t topic_msg(topic.begin(), topic.end());
        publisher.send(topic_msg, zmq::send_flags::sndmore);

        // å†å‘é€æ¶ˆæ¯å†…å®¹
        zmq::message_t content_msg(message.begin(), message.end());
        publisher.send(content_msg, zmq::send_flags::none);

        std::cout &lt;&lt; "Published: " &lt;&lt; topic &lt;&lt; " - " &lt;&lt; message &lt;&lt; "\n";

        std::this_thread::sleep_for(std::chrono::seconds(1));
    }

    return 0;
}</code></pre>

        <h3>è®¢é˜…è€…ï¼ˆSUBï¼‰</h3>
        <pre><code>#include &lt;zmq.hpp&gt;
#include &lt;iostream&gt;
#include &lt;string&gt;

int main() {
    zmq::context_t context(1);
    zmq::socket_t subscriber(context, ZMQ_SUB);
    subscriber.connect("tcp://localhost:5556");

    // è®¾ç½®è¿‡æ»¤å™¨ï¼šåªè®¢é˜… "news" ä¸»é¢˜
    std::string filter = "news";
    subscriber.set(zmq::sockopt::subscribe, filter);

    std::cout &lt;&lt; "Subscriber started\n";

    while (true) {
        // æ¥æ”¶ä¸»é¢˜
        zmq::message_t topic_msg;
        subscriber.recv(topic_msg, zmq::recv_flags::none);
        std::string topic(static_cast&lt;char*&gt;(topic_msg.data()), topic_msg.size());

        // æ¥æ”¶æ¶ˆæ¯å†…å®¹
        zmq::message_t content_msg;
        auto recv_result = subscriber.recv(content_msg, zmq::recv_flags::none);
        std::string content(static_cast&lt;char*&gt;(content_msg.data()), content_msg.size());

        std::cout &lt;&lt; "Received: [" &lt;&lt; topic &lt;&lt; "] " &lt;&lt; content &lt;&lt; "\n";
    }

    return 0;
}</code></pre>

        <h2>âš¡ PUSH-PULL æ¨¡å¼ï¼ˆç®¡é“ï¼‰</h2>

        <h3>æ¨æ‹‰è€…ï¼ˆPUSHï¼‰</h3>
        <pre><code>#include &lt;zmq.hpp&gt;
#include &lt;iostream&gt;
#include &lt;thread&gt;
#include &lt;chrono&gt;

int main() {
    zmq::context_t context(1);
    zmq::socket_t pusher(context, ZMQ_PUSH);
    pusher.bind("tcp://*:5557");

    std::cout &lt;&lt; "Pusher started\n";

    for (int i = 0; i &lt; 10; i++) {
        std::string message = "Task #" + std::to_string(i);
        zmq::message_t msg(message.begin(), message.end());
        
        pusher.send(msg, zmq::send_flags::none);
        std::cout &lt;&lt; "Sent: " &lt;&lt; message &lt;&lt; "\n";

        std::this_thread::sleep_for(std::chrono::milliseconds(500));
    }

    return 0;
}</code></pre>

        <h3>æ‹‰å–è€…ï¼ˆPULLï¼‰</h3>
        <pre><code>#include &lt;zmq.hpp&gt;
#include &lt;iostream&gt;
#include &lt;thread&gt;

int main() {
    zmq::context_t context(1);
    zmq::socket_t puller(context, ZMQ_PULL);
    puller.connect("tcp://localhost:5557");

    std::cout &lt;&lt; "Puller started\n";

    while (true) {
        zmq::message_t msg;
        auto recv_result = puller.recv(msg, zmq::recv_flags::none);
        
        std::string message(static_cast&lt;char*&gt;(msg.data()), msg.size());
        std::cout &lt;&lt; "Received: " &lt;&lt; message 
                  &lt;&lt; " on thread " &lt;&lt; std::this_thread::get_id() &lt;&lt; "\n";
        
        std::this_thread::sleep_for(std::chrono::seconds(1));
    }

    return 0;
}</code></pre>

        <h2>ğŸ”„ é«˜çº§åŠŸèƒ½</h2>

        <h3>å¤šéƒ¨åˆ†æ¶ˆæ¯</h3>
        <pre><code>#include &lt;zmq.hpp&gt;
#include &lt;iostream&gt;

int main() {
    zmq::context_t context(1);
    zmq::socket_t sender(context, ZMQ_PAIR);
    sender.bind("inproc://test");

    zmq::socket_t receiver(context, ZMQ_PAIR);
    receiver.connect("inproc://test");

    // å‘é€å¤šéƒ¨åˆ†æ¶ˆæ¯
    std::string part1 = "Header";
    std::string part2 = "Body";
    std::string part3 = "Footer";

    zmq::message_t msg1(part1.begin(), part1.end());
    zmq::message_t msg2(part2.begin(), part2.end());
    zmq::message_t msg3(part3.begin(), part3.end());

    // ä½¿ç”¨ sndmore æ ‡å¿—å‘é€å¤šéƒ¨åˆ†æ¶ˆæ¯
    sender.send(msg1, zmq::send_flags::sndmore);
    sender.send(msg2, zmq::send_flags::sndmore);
    sender.send(msg3, zmq::send_flags::none);

    std::cout &lt;&lt; "Sent 3-part message\n";

    // æ¥æ”¶å¤šéƒ¨åˆ†æ¶ˆæ¯
    zmq::message_t recv1, recv2, recv3;
    receiver.recv(recv1, zmq::recv_flags::none);
    receiver.recv(recv2, zmq::recv_flags::none);
    receiver.recv(recv3, zmq::recv_flags::none);

    std::cout &lt;&lt; "Received: " 
              &lt;&lt; std::string(static_cast&lt;char*&gt;(recv1.data()), recv1.size()) &lt;&lt; " "
              &lt;&lt; std::string(static_cast&lt;char*&gt;(recv2.data()), recv2.size()) &lt;&lt; " "
              &lt;&lt; std::string(static_cast&lt;char*&gt;(recv3.data()), recv3.size()) &lt;&lt; "\n";

    return 0;
}</code></pre>

        <h3>è®¾ç½®è¶…æ—¶</h3>
        <pre><code>#include &lt;zmq.hpp&gt;
#include &lt;iostream&gt;

int main() {
    zmq::context_t context(1);
    zmq::socket_t socket(context, ZMQ_SUB);
    socket.connect("tcp://localhost:5556");
    socket.set(zmq::sockopt::subscribe, "");

    // è®¾ç½®æ¥æ”¶è¶…æ—¶ï¼ˆæ¯«ç§’ï¼‰
    int timeout_ms = 1000;
    socket.set(zmq::sockopt::rcvtimeo, timeout_ms);

    std::cout &lt;&lt; "Waiting for messages with 1s timeout...\n";

    while (true) {
        zmq::message_t msg;
        auto result = socket.recv(msg, zmq::recv_flags::none);

        if (result) {
            std::cout &lt;&lt; "Received: " 
                      &lt;&lt; std::string(static_cast&lt;char*&gt;(msg.data()), msg.size()) &lt;&lt; "\n";
        } else {
            std::cout &lt;&lt; "Timeout, no message received\n";
        }
    }

    return 0;
}</code></pre>

        <h3>è®¾ç½®å‘é€/æ¥æ”¶ç¼“å†²åŒºå¤§å°</h3>
        <pre><code>zmq::socket_t socket(context, ZMQ_PUB);

// è®¾ç½®å‘é€ç¼“å†²åŒºå¤§å°ï¼ˆæ¶ˆæ¯æ•°ï¼‰
int sndhwm = 1000;
socket.set(zmq::sockopt::sndhwm, sndhwm);

// è®¾ç½®æ¥æ”¶ç¼“å†²åŒºå¤§å°
int rcvhwm = 1000;
socket.set(zmq::sockopt::rcvhwm, rcvhwm);</code></pre>

        <h3>ä½¿ç”¨ poll ç›‘å¬å¤šä¸ªå¥—æ¥å­—</h3>
        <pre><code>#include &lt;zmq.hpp&gt;
#include &lt;zmq_poll.h&gt;
#include &lt;iostream&gt;

int main() {
    zmq::context_t context(1);

    // åˆ›å»ºä¸¤ä¸ªè®¢é˜…è€…
    zmq::socket_t sub1(context, ZMQ_SUB);
    sub1.connect("tcp://localhost:5556");
    sub1.set(zmq::sockopt::subscribe, "topic1");

    zmq::socket_t sub2(context, ZMQ_SUB);
    sub2.connect("tcp://localhost:5557");
    sub2.set(zmq::sockopt::subscribe, "topic2");

    // è®¾ç½® poll é¡¹
    zmq::pollitem_t items[] = {
        { static_cast&lt;void*&gt;(sub1), 0, ZMQ_POLLIN, 0 },
        { static_cast&lt;void*&gt;(sub2), 0, ZMQ_POLLIN, 0 }
    };

    std::cout &lt;&lt; "Listening on both sockets...\n";

    while (true) {
        // ç­‰å¾…ä»»ä¸€å¥—æ¥å­—æœ‰æ¶ˆæ¯ï¼ˆè¶…æ—¶ -1 è¡¨ç¤ºæ— é™ç­‰å¾…ï¼‰
        zmq::poll(items, 2, -1);

        // æ£€æŸ¥ sub1
        if (items[0].revents & ZMQ_POLLIN) {
            zmq::message_t msg;
            sub1.recv(msg, zmq::recv_flags::none);
            std::cout &lt;&lt; "From sub1: " 
                      &lt;&lt; std::string(static_cast&lt;char*&gt;(msg.data()), msg.size()) &lt;&lt; "\n";
        }

        // æ£€æŸ¥ sub2
        if (items[1].revents & ZMQ_POLLIN) {
            zmq::message_t msg;
            sub2.recv(msg, zmq::recv_flags::none);
            std::cout &lt;&lt; "From sub2: " 
                      &lt;&lt; std::string(static_cast&lt;char*&gt;(msg.data()), msg.size()) &lt;&lt; "\n";
        }
    }

    return 0;
}</code></pre>

        <h2>ğŸ’¼ å®é™…åº”ç”¨ç¤ºä¾‹</h2>

        <h3>ä»»åŠ¡åˆ†å‘ç³»ç»Ÿ</h3>
        <h4>ä»»åŠ¡åˆ†å‘å™¨ï¼ˆVentilatorï¼‰</h4>
        <pre><code>#include &lt;zmq.hpp&gt;
#include &lt;iostream&gt;
#include &lt;thread&gt;
#include &lt;vector&gt;

int main() {
    zmq::context_t context(1);

    // æ¥æ”¶å®¢æˆ·ç«¯çš„è¯·æ±‚
    zmq::socket_t receiver(context, ZMQ_PULL);
    receiver.bind("tcp://*:5555");

    // å‘é€ä»»åŠ¡ç»™å·¥ä½œèŠ‚ç‚¹
    zmq::socket_t sender(context, ZMQ_PUSH);
    sender.bind("tcp://*:5557");

    std::cout &lt;&lt; "Task dispatcher started\n";

    // ç­‰å¾…å®¢æˆ·ç«¯å‡†å¤‡å°±ç»ª
    zmq::message_t msg;
    receiver.recv(msg, zmq::recv_flags::none);
    std::cout &lt;&lt; "Client ready, starting to send tasks\n";

    // å‘é€100ä¸ªä»»åŠ¡
    for (int i = 0; i &lt; 100; i++) {
        std::string task = "Task_" + std::to_string(i);
        zmq::message_t task_msg(task.begin(), task.end());
        sender.send(task_msg, zmq::send_flags::none);
    }

    // å‘é€ç»“æŸä¿¡å·
    std::string done = "DONE";
    zmq::message_t done_msg(done.begin(), done.end());
    sender.send(done_msg, zmq::send_flags::none);

    std::cout &lt;&lt; "All tasks sent\n";

    return 0;
}</code></pre>

        <h4>å·¥ä½œèŠ‚ç‚¹ï¼ˆWorkerï¼‰</h4>
        <pre><code>#include &lt;zmq.hpp&gt;
#include &lt;iostream&gt;
#include &lt;thread&gt;
#include &lt;random&gt;

int main() {
    zmq::context_t context(1);

    // æ¥æ”¶ä»»åŠ¡
    zmq::socket_t receiver(context, ZMQ_PULL);
    receiver.connect("tcp://localhost:5557");

    // å‘é€ç»“æœ
    zmq::socket_t sender(context, ZMQ_PUSH);
    sender.connect("tcp://localhost:5558");

    std::random_device rd;
    std::mt19937 gen(rd());
    std::uniform_int_distribution&lt;&gt; dis(100, 500);

    while (true) {
        zmq::message_t msg;
        receiver.recv(msg, zmq::recv_flags::none);

        std::string task(static_cast&lt;char*&gt;(msg.data()), msg.size());

        if (task == "DONE") {
            std::cout &lt;&lt; "Worker finished\n";
            break;
        }

        // å¤„ç†ä»»åŠ¡ï¼ˆæ¨¡æ‹Ÿï¼‰
        int process_time = dis(gen);
        std::cout &lt;&lt; "Processing: " &lt;&lt; task 
                  &lt;&lt; " (" &lt;&lt; process_time &lt;&lt; "ms)\n";
        std::this_thread::sleep_for(std::chrono::milliseconds(process_time));

        // å‘é€ç»“æœ
        zmq::message_t result(msg.data(), msg.size());
        sender.send(result, zmq::send_flags::none);
    }

    return 0;
}</code></pre>

        <h3>å®æ—¶æ—¥å¿—ç³»ç»Ÿ</h3>
        <h4>æ—¥å¿—æ”¶é›†å™¨</h4>
        <pre><code>#include &lt;zmq.hpp&gt;
#include &lt;iostream&gt;
#include &lt;fstream&gt;
#include &lt;chrono&gt;
#include &lt;ctime&gt;

std::string get_timestamp() {
    auto now = std::chrono::system_clock::now();
    auto time = std::chrono::system_clock::to_time_t(now);
    char buf[100];
    std::strftime(buf, sizeof(buf), "%Y-%m-%d %H:%M:%S", std::localtime(&time));
    return buf;
}

int main() {
    zmq::context_t context(1);
    zmq::socket_t collector(context, ZMQ_SUB);
    collector.bind("tcp://*:5559");

    // è®¢é˜…æ‰€æœ‰ä¸»é¢˜
    collector.set(zmq::sockopt::subscribe, "");

    std::ofstream logfile("application.log", std::ios::app);

    std::cout &lt;&lt; "Log collector started\n";

    while (true) {
        // æ¥æ”¶æ—¥å¿—çº§åˆ«ï¼ˆä¸»é¢˜ï¼‰
        zmq::message_t level_msg;
        collector.recv(level_msg, zmq::recv_flags::none);
        std::string level(static_cast&lt;char*&gt;(level_msg.data()), level_msg.size());

        // æ¥æ”¶æ—¥å¿—æ¶ˆæ¯
        zmq::message_t msg;
        collector.recv(msg, zmq::recv_flags::none);
        std::string log_msg(static_cast&lt;char*&gt;(msg.data()), msg.size());

        // æ ¼å¼åŒ–æ—¥å¿—
        std::string formatted = "[" + get_timestamp() + "] [" + level + "] " + log_msg;

        // è¾“å‡ºåˆ°æ§åˆ¶å°
        std::cout &lt;&lt; formatted &lt;&lt; "\n";

        // å†™å…¥æ–‡ä»¶
        logfile &lt;&lt; formatted &lt;&lt; "\n";
        logfile.flush();
    }

    return 0;
}</code></pre>

        <h4>æ—¥å¿—ç”Ÿæˆå™¨</h4>
        <pre><code>#include &lt;zmq.hpp&gt;
#include &lt;iostream&gt;
#include &lt;string&gt;
#include &lt;thread&gt;

int main() {
    zmq::context_t context(1);
    zmq::socket_t logger(context, ZMQ_PUB);
    logger.connect("tcp://localhost:5559");

    std::this_thread::sleep_for(std::chrono::seconds(1));  // ç­‰å¾…è¿æ¥

    while (true) {
        std::string level;
        std::string message;

        std::cout &lt;&lt; "Enter level (INFO/WARN/ERROR): ";
        std::cin &gt;&gt; level;

        std::cout &lt;&lt; "Enter message: ";
        std::cin.ignore();
        std::getline(std::cin, message);

        // å‘é€å¤šéƒ¨åˆ†æ¶ˆæ¯ï¼šä¸»é¢˜ + å†…å®¹
        zmq::message_t level_msg(level.begin(), level.end());
        logger.send(level_msg, zmq::send_flags::sndmore);

        zmq::message_t msg(message.begin(), message.end());
        logger.send(msg, zmq::send_flags::none);

        std::cout &lt;&lt; "Log sent\n";
    }

    return 0;
}</code></pre>

        <h2>ğŸ“‹ ZeroMQ å¥—æ¥å­—ç±»å‹é€ŸæŸ¥</h2>

        <table>
            <thead>
                <tr>
                    <th>ç±»å‹</th>
                    <th>æ–¹å‘</th>
                    <th>è¯´æ˜</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><code>ZMQ_REQ</code></td>
                    <td>å®¢æˆ·ç«¯</td>
                    <td>è¯·æ±‚-å“åº”å®¢æˆ·ç«¯</td>
                </tr>
                <tr>
                    <td><code>ZMQ_REP</code></td>
                    <td>æœåŠ¡ç«¯</td>
                    <td>è¯·æ±‚-å“åº”æœåŠ¡ç«¯</td>
                </tr>
                <tr>
                    <td><code>ZMQ_DEALER</code></td>
                    <td>å®¢æˆ·ç«¯</td>
                    <td>é«˜çº§è¯·æ±‚-å“åº”å®¢æˆ·ç«¯</td>
                </tr>
                <tr>
                    <td><code>ZMQ_ROUTER</code></td>
                    <td>æœåŠ¡ç«¯</td>
                    <td>é«˜çº§è¯·æ±‚-å“åº”æœåŠ¡ç«¯</td>
                </tr>
                <tr>
                    <td><code>ZMQ_PUB</code></td>
                    <td>å‘å¸ƒè€…</td>
                    <td>å‘å¸ƒ-è®¢é˜…æ¨¡å¼å‘å¸ƒè€…</td>
                </tr>
                <tr>
                    <td><code>ZMQ_SUB</code></td>
                    <td>è®¢é˜…è€…</td>
                    <td>å‘å¸ƒ-è®¢é˜…æ¨¡å¼è®¢é˜…è€…</td>
                </tr>
                <tr>
                    <td><code>ZMQ_PUSH</code></td>
                    <td>æ¨æ‹‰è€…</td>
                    <td>ç®¡é“æ¨¡å¼æ¨é€ç«¯</td>
                </tr>
                <tr>
                    <td><code>ZMQ_PULL</code></td>
                    <td>æ‹‰å–è€…</td>
                    <td>ç®¡é“æ¨¡å¼æ‹‰å–ç«¯</td>
                </tr>
                <tr>
                    <td><code>ZMQ_PAIR</code></td>
                    <td>å¯¹ç­‰</td>
                    <td>å¯¹ç­‰é€šä¿¡æ¨¡å¼</td>
                </tr>
            </tbody>
        </table>

        <div class="note">
            <strong>ğŸ’¡ æç¤ºï¼š</strong> cppzmq ä½¿ç”¨ RAII æ¨¡å¼è‡ªåŠ¨ç®¡ç†èµ„æºï¼Œå¥—æ¥å­—åœ¨ææ„æ—¶ä¼šè‡ªåŠ¨å…³é—­ï¼Œä¸Šä¸‹æ–‡åœ¨ææ„æ—¶ä¼šè‡ªåŠ¨ç»ˆæ­¢ã€‚è¿™æ¯”åŸç”Ÿçš„ C API æ›´å®‰å…¨ã€‚
        </div>

        <div class="warning">
            <strong>âš ï¸ æ³¨æ„ï¼š</strong> 
            <ul>
                <li>PUB-SUB æ¨¡å¼ä¸­ï¼Œè®¢é˜…è€…å¯èƒ½ä¼šä¸¢å¤±å‘å¸ƒè€…åœ¨è®¢é˜…è¿æ¥å‰å‘é€çš„æ¶ˆæ¯</li>
                <li>ç¡®ä¿æ­£ç¡®å¤„ç† zmq::sockopt::subscribe è®¾ç½®ï¼ˆç©ºå­—ç¬¦ä¸²è®¢é˜…æ‰€æœ‰ä¸»é¢˜ï¼‰</li>
                <li>å¤šéƒ¨åˆ†æ¶ˆæ¯ä¸­ï¼Œæœ€åä¸€å¸§ä¸è¦ä½¿ç”¨ sndmore æ ‡å¿—</li>
                <li>ä½¿ç”¨ poll æ—¶æ³¨æ„å¤„ç†è¶…æ—¶æƒ…å†µ</li>
            </ul>
        </div>

        <h2>ğŸ”— å‚è€ƒèµ„æ–™</h2>
        <ul>
            <li><a href="https://github.com/zeromq/cppzmq" target="_blank" style="color: #4cd1a8;">cppzmq GitHub</a></li>
            <li><a href="https://zeromq.org/" target="_blank" style="color: #4cd1a8;">ZeroMQ å®˜æ–¹ç½‘ç«™</a></li>
            <li><a href="https://zguide.zeromq.org/" target="_blank" style="color: #4cd1a8;">ZeroMQ æŒ‡å—</a></li>
        </ul>

        <!-- é¡µè„š -->
        <footer>
            <p class="footer-text">&copy; 2026 C++ å¼€æºåº“ç²¾é€‰åŸºåœ°. ç‰ˆæƒæ‰€æœ‰Â·LEVI</p>
            <p class="footer-text">å¦‚æœ‰ç–‘é—®ï¼Œè¯·è”ç³»: <a href="mailto:373102227@qq.com" class="contact-link">373102227@qq.com</a> æˆ– <a href="mailto:liweixs@gmail.com" class="contact-link">liweixs@gmail.com</a></p>
        </footer>
    </div>
</body>
</html>
